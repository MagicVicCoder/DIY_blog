<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>我的博客</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <header>
    <h1>欢迎来到我的博客！</h1>
    <nav>
      {% if current_user.is_authenticated %}
        <span>你好，{{ current_user.username }}！</span> |
        <a href="{{ url_for('new_post') }}">发布文章</a> |
        <a href="{{ url_for('logout') }}">登出</a>
      {% else %}
        <a href="{{ url_for('login') }}">登录</a> |
        <a href="{{ url_for('register') }}">注册</a>
      {% endif %}
    </nav>
    <hr />
  </header>

  <main>
    {% if articles %}
      {% for post in articles %}
        <section class="post-preview">
          <h2>
            <a href="{{ url_for('post_detail', post_id=post.id) }}">
              {{ post.title }}
            </a>
          </h2>
          <p class="intro">
            {{ post.content[:100] | safe }}…
          </p>
          <p class="meta">
            作者：{{ post.author.username }} |
            发布于：{{ post.created.strftime('%Y-%m-%d %H:%M') }}
          </p>
          <p>
            <a class="read-more" href="{{ url_for('post_detail', post_id=post.id) }}">
              阅读全文 →
            </a>
            {% if current_user.is_authenticated and
                  (current_user.id == post.author_id or current_user.is_admin) %}
              <form action="{{ url_for('delete_post', post_id=post.id) }}"
                    method="post" style="display:inline;">
                <button type="submit">删除</button>
              </form>
            {% endif %}
          </p>
        </section>
        <hr />
      {% endfor %}
    {% else %}
      <p>暂无文章，快去发布第一篇吧！</p>
    {% endif %}
  </main>
</body>
</html>




